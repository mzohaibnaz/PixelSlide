/*
plugin name: pixelSlide
Developer: Zohaib Naz
Developer profile: https://www.facebook.com/zebi.rajpot
*/

(function ( $ ) {
 
    $.fn.pixelSlide = function( options ) {
 
        var settings = $.extend({
            // These are the defaults.
            width: 0,
            height: 190,
            items: 3,
            nextBtn: false,
            prevBtn: false,
            pauseBtn: false,
            startBtn: false,
            mode: "horizontal",
            margin: 10,
            speed: 1000,
            auto: false,
            delay: 2000,
            toggleClass: false,
            effect: "scroll",
            tag: "span"
        }, options );
        var itemLength = this.children(settings.tag).length;
        var itemMove = 0;
        var scrollSpeed = 0;
        var FXspeed = (settings.speed / 2);
        // check if other effect not exits
        if(settings.effect != "scroll"){
            scrollSpeed = 0;
        }else{
            scrollSpeed = settings.speed;
        }
        // hide next button if there is only 1 item
        if(itemLength == settings.items){
            $(settings.nextBtn).hide();
        }
        // make main div overflow hidden
        this.css("overflow","hidden");
        // add buttons of next and previous if use not defined
        if(settings.prevBtn == false){
            settings.prevBtn = ".prev";
            $("<"+settings.tag+" class='prev'>Prev</"+settings.tag+">").insertBefore(this);
        }
        if(settings.nextBtn == false){
            settings.nextBtn = ".next";
            $("<"+settings.tag+" class='next'>Next</"+settings.tag+">").insertBefore(this);
        }
        // add start/pause button if auto is true
        if(settings.auto == true){
            if(settings.pauseBtn == false){
                settings.pauseBtn = ".pauseBtn";
                $("<"+settings.tag+" class='pauseBtn'>Pause</"+settings.tag+">").insertBefore(this);
            }
            if(settings.startBtn == false){
                settings.startBtn = ".startBtn";
                $("<"+settings.tag+" class='startBtn'>Start</"+settings.tag+">").insertBefore(this);
            }
        }
        // hide or show start button depends on auto start
        if(settings.auto == false){
            if(settings.toggleClass == false){
                $(settings.pauseBtn).hide();
                $(settings.startBtn).show();
            }else{
                $(settings.pauseBtn).addClass(settings.toggleClass);
                $(settings.startBtn).removeClass(settings.toggleClass);
            }
        }else{
            if(settings.toggleClass == false){
                $(settings.pauseBtn).show();
                $(settings.startBtn).hide();
            }else{
                $(settings.pauseBtn).removeClass(settings.toggleClass);
                $(settings.startBtn).addClass(settings.toggleClass);
            }
        }
        // check slider is horizontal or vertical
        if(settings.mode != "vertical"){
            this.html('<div class="pixelSlide-wrap" style="position: relative; width: '+(itemLength * settings.width + 500) +'px; height: '+settings.height+'px;">'+this.html()+'</div>');
        }else{
            this.html('<div class="pixelSlide-wrap" style="position: relative;">'+this.html()+'</div>');
        }
        
        // how much slider have steps
        var steps = Math.ceil(itemLength / settings.items);
        //alert(steps);
        // add pixelSlide-active class and get its index
        $(".pixelSlide-wrap > "+settings.tag+":first").addClass("pixelSlide-active");
        var itemIndex = 0;
        
        // next button click
        $(settings.nextBtn).click(function(){
            if($(this).hasClass(settings.toggleClass)){
                return false;
            }
               //show previous button
               if(settings.toggleClass == false){
                    $(settings.prevBtn).show();
               }else{
                    $(settings.prevBtn).removeClass(settings.toggleClass);
               }
               itemIndex += settings.items;
               $(".pixelSlide-wrap > "+settings.tag+":eq("+(itemIndex - (settings.items))+")").removeClass("pixelSlide-active");
               $(".pixelSlide-wrap > "+settings.tag+":eq("+itemIndex+")").addClass("pixelSlide-active");
               
               // effect section
               // jQuery Ui effects
               if(settings.effect != "scroll"){
                   $(".pixelSlide-wrap").hide(settings.effect,FXspeed);
               }
               if(settings.mode != "vertical"){
                   if((itemLength - itemIndex) <  settings.items){
                        itemMove += (settings.width + settings.margin) * (itemLength - itemIndex);
                   }else{
                        itemMove += (settings.width + settings.margin) * settings.items;
                   }
                   $(".pixelSlide-wrap").animate({ 
                       left: "-"+itemMove+"px"
                   },scrollSpeed);
               }else{
                    if((itemLength - itemIndex) <  settings.items){
                        itemMove += (settings.height + settings.margin) * (itemLength - itemIndex);
                    }else{
                        itemMove += (settings.height + settings.margin) * settings.items;
                    }
                   $(".pixelSlide-wrap").animate({ 
                        top: "-"+itemMove+"px"
                   },scrollSpeed);
               }
               // jQuery Ui effects
                   if(settings.effect != "scroll"){
                       $(".pixelSlide-wrap").show(settings.effect,FXspeed);
                   }
           if((itemLength - itemIndex) <  settings.items){
                if(settings.toggleClass == false){
                    $(this).hide();
                }else{
                    $(this).addClass(settings.toggleClass);
                }
           }
           if((itemIndex + settings.items) == itemLength){
                if(settings.toggleClass == false){
                    $(this).hide();
                }else{
                    $(this).addClass(settings.toggleClass);
                }
           }else{
                if(settings.toggleClass == false){
                    $(settings.prevBtn).show();
                }else{
                    $(settings.prevBtn).removeClass(settings.toggleClass);
                }
           }
           
        });
        
        // prev button click
        if(settings.toggleClass == false){
            $(settings.prevBtn).hide();
        }else{
            $(settings.prevBtn).addClass(settings.toggleClass);
        }
        $(settings.prevBtn).click(function(){
            if($(this).hasClass(settings.toggleClass)){
                return false;
            }
           itemIndex -= settings.items;
       
           if(itemIndex == 0){
               if(settings.toggleClass == false){
                   $(settings.prevBtn).hide();
               }else{
                   $(settings.prevBtn).addClass(settings.toggleClass);
               }
           } 
           $(".pixelSlide-wrap > "+settings.tag+":eq("+(itemIndex + (settings.items))+")").removeClass("pixelSlide-active");
           $(".pixelSlide-wrap > "+settings.tag+":eq("+itemIndex+")").addClass("pixelSlide-active");
           
           // jQuery Ui effects
           if(settings.effect != "scroll"){
               $(".pixelSlide-wrap").hide(settings.effect,FXspeed);
           }
           if(settings.mode != "vertical"){
               itemMove -= (settings.width + settings.margin) * settings.items;
               if(itemMove < 0){
                    itemMove = 0;
               }
               $(".pixelSlide-wrap").animate({ 
                    left: "-"+itemMove+"px"
               },scrollSpeed);
           }else{
               itemMove -= (settings.height + settings.margin) * settings.items;
               if(itemMove < 0){
                    itemMove = 0;
               }
               $(".pixelSlide-wrap").animate({ 
                    top: "-"+itemMove+"px"
               },scrollSpeed);
           }
           // jQuery Ui effects
           if(settings.effect != "scroll"){
               $(".pixelSlide-wrap").show(settings.effect,FXspeed);
           }
           if((itemIndex - settings.items) == itemLength){
                if(settings.toggleClass == false){
                    $(this).hide();
                }else{
                    $(this).addClass(settings.toggleClass);
                }
           }else{
                if(settings.toggleClass == false){
                    $(settings.nextBtn).show();
                }else{
                    $(settings.nextBtn).removeClass(settings.toggleClass);
                }
           }
           
        });
        
        // run slide auto with interval function
        var direction = "right";
        var autoRunID = false;
        function autoRun(){
               autoRunID = setInterval(function(){
                    if(itemIndex == 0){
                        direction = "right";
                    }else if((itemLength - itemIndex) <  settings.items){
                        direction = "left";
                    }
                    if(direction == "right"){
                        $(settings.nextBtn).click();
                    }else{
                        $(settings.prevBtn).click();
                    }
                },(settings.delay + settings.speed));
        }
        // start slider if auto start is true
        if(settings.auto == true){
            autoRun();
        }
        // pause slider on button start click
        $(settings.pauseBtn).click(function(){
            if(settings.toggleClass == false){
                $(this).hide();
                $(settings.startBtn).show();
            }else{
                $(this).addClass(settings.toggleClass);
                $(settings.startBtn).removeClass(settings.toggleClass);
            }
            clearInterval(autoRunID);
        });
        // start slider on button start click
        $(settings.startBtn).click(function(){
            if(settings.toggleClass == false){
                $(this).hide();
                $(settings.pauseBtn).show();
            }else{
                $(this).addClass(settings.toggleClass);
                $(settings.pauseBtn).removeClass(settings.toggleClass);
            }
            autoRun();
        });
        return this;
    };
 
}( jQuery ));